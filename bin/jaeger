#!/bin/bash

set -e

IMAGE=jaegertracing/all-in-one
PARAMS=

case "$1" in
-u | --update) exec docker pull "$IMAGE" ;;
-s | --service) PARAMS="search?service=$2" ;;
esac

( sleep 2; open --url "http://localhost:16686/$PARAMS" ) &

exec docker run -it --rm \
    -p6831:6831/udp \
    -p6832:6832/udp \
    -p16686:16686 \
    -p14268:14268 \
    "$IMAGE:latest"
