# vim: ft=sh

alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'

alias t='tree'
alias ta='tree -a'

alias bx='bundle exec'
alias bi='bundle install --jobs=3 --retry=3'
alias bu='bundle update --jobs=3 --retry=3'

complete -o default -F __start_kubectl kc
alias kn=kubens;  complete -F _kube_namespaces kn
alias kx=kubectx; complete -F _kube_contexts kx
alias kw='watch "kubectl get pods -A | grep -vE \"(Completed|Running)\""'

_awsvault() {
    local profile
    local cmd="$1"
    shift
    if test $# -eq 0; then
        profile=$(aws-vault list --profiles | fzf) || return 1
        echo "$profile" >&2
        aws-vault "$cmd" "$profile"
    else
        aws-vault "$cmd" "$@"
    fi
}
ax() { _awsvault exec  "$@"; }
al() { _awsvault login "$@"; }

_awsvault_compl() {
    local cur profiles
    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"
    if test $COMP_CWORD -eq 1; then
        profiles=$(aws-vault list --profiles) || return 1
        COMPREPLY=( $(compgen -W "$profiles" -- $cur) )
        return 0
    fi
}
complete -o default -F _awsvault_compl ax al

alias hd='hexdump -C'

alias ubuntu='docker run -it --rm -v $(PWD):/data -w /data ubuntu:18.04 /bin/bash'
alias centos='docker run -it --rm -v $(PWD):/data -w /data centos:7 /bin/bash'
alias alpine='docker run -it --rm -v $(PWD):/data -w /data alpine /bin/sh'

alias fix-spotlight='sudo mdutil -i on /'
alias fix-dns='sudo killall -HUP mDNSResponder'

# fat fingers...
alias gti=git
alias got=go
alias bim=vim

:
